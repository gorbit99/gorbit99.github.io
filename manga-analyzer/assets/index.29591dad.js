var Q=Object.defineProperty,ee=Object.defineProperties;var te=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable;var M=(e,n,o)=>n in e?Q(e,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[n]=o,A=(e,n)=>{for(var o in n||(n={}))ne.call(n,o)&&M(e,o,n[o]);if(B)for(var o of B(n))oe.call(n,o)&&M(e,o,n[o]);return e},W=(e,n)=>ee(e,te(n));import"./vendor.0bc0745c.js";const re=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))t(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&t(u)}).observe(document,{childList:!0,subtree:!0});function o(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerpolicy&&(a.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?a.credentials="include":r.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function t(r){if(r.ep)return;r.ep=!0;const a=o(r);fetch(r.href,a)}};re();function ae(){const e=document.querySelector(".upload__drop-zone"),n=document.querySelector(".upload__file-input"),o=document.querySelector(".upload__button"),t=document.querySelector(".upload__drop-zone-text");n.files=null,o.disabled=!0,e.addEventListener("click",()=>{n.click()}),n.addEventListener("change",()=>{const r=n.files;r!=null&&(o.classList.add("upload__button--excited"),o.classList.remove("upload__button--inactive"),o.disabled=!1,t.textContent=`${r.length} files selected`)}),o.addEventListener("click",()=>{o.classList.remove("upload__button--excited")})}function ce(e){document.querySelector(".upload__button").addEventListener("click",()=>{var r;const o=document.querySelector(".upload__file-input"),t=Array.from((r=o.files)!=null?r:[]);e(t)})}const L={adjective:"\u5F62\u5BB9\u8A5E",adverb:"\u526F\u8A5E",adnominal:"\u9023\u4F53\u8A5E",filler:"\u30D5\u30A3\u30E9\u30FC",conjunction:"\u63A5\u7D9A\u8A5E",noun:"\u540D\u8A5E",auxiliaryVerb:"\u52A9\u52D5\u8A5E",interjection:"\u611F\u52D5\u8A5E",other:"\u305D\u306E\u4ED6",prefix:"\u63A5\u982D\u8A5E",particle:"\u52A9\u8A5E",symbol:"\u8A18\u53F7",verb:"\u52D5\u8A5E"};function se(){var e;(e=document.querySelector(".loading"))==null||e.classList.remove("loading--hidden")}function ue(){var e;(e=document.querySelector(".loading"))==null||e.classList.add("loading--hidden")}function j(e){const n=document.querySelector(".loading__text");n.textContent=e}let I;async function le(e){se(),ie(e);const n=await de(e),o=ge(n);I===void 0&&(I=await fe());const t=pe(o);return ue(),{lines:o,words:t}}function ie(e){const n=o=>parseInt(o.name.split(".")[0]);return e.sort((o,t)=>n(o)-n(t))}async function de(e){const n=[];for(const o of e){j(`Loading files... ${n.length+1}/${e.length}`);const t=await me(o);n.push(t)}return n}async function me(e){const n=new FileReader;return n.readAsText(e),new Promise((o,t)=>{n.onload=()=>{const r=JSON.parse(n.result);o(r)},n.onerror=()=>{t(n.error)}})}function ge(e){return e.map(n=>n.blocks.map(o=>o.lines.join(" ")))}function fe(){return j("Loading kuromoji..."),new Promise((e,n)=>{kuromoji.builder({dicPath:"https://cdn.jsdelivr.net/npm/kuromoji@0.1.2/dict"}).build((o,t)=>{o&&n(o),e(t)})})}function pe(e){return j("Extracting words..."),e.map(n=>n.flatMap(o=>ve(o)))}function ve(e){const n=[L.noun,L.verb,L.adverb,L.adjective,L.adnominal];return I.tokenize(e).filter(t=>n.includes(t.pos)&&t.basic_form!=="*").map(t=>t.basic_form)}function S(e){return(Math.round(e*100)/100).toString()}function E(e,n,o,t){const r=e.querySelector(".results__info-value"),a=e.querySelector(".results__info-average"),u=e.querySelector(".results__info-deviation");if(r.textContent=S(n),o!==void 0&&t!==void 0){a.textContent=S(o);const s=t>0?"+":"";u.textContent=s+S(t)}e.classList.toggle("results__info-group--no-average",o===void 0)}const O={showAveragesFor:"abbc"};function _e(){const e=document.querySelector(".settings__icon"),n=document.querySelector(".settings");e.addEventListener("click",()=>{n.classList.toggle("settings--open")});const o=V();for(const t in o){const r=document.querySelector(`#${t}`);r.value=o[t],r.addEventListener("change",()=>{o[t]=r.value,R(o)})}}function V(){return window.localStorage.getItem("settings")===null?(R(O),O):JSON.parse(window.localStorage.getItem("settings"))}function R(e){window.localStorage.setItem("settings",JSON.stringify(e))}function H(e){return V()[e]}function he(e,n,o,t,r=!0){const a=document.querySelector("#diagramTemplate"),u=a.content.querySelector(".results__diagram").cloneNode(!0),s=a.content.querySelector("#diagramColumnTemplate"),i=a.content.querySelector("#diagramColumnWithHorizontalTemplate"),d=a.content.querySelector("#diagramHorizontalLineTemplate"),g=a.content.querySelector("#diagramAverageLineTemplate"),c=a.content.querySelector("#diagramValueLineTemplate"),l=u.querySelector(".results__diagram-data"),q=Math.min(...e.map(h=>h.value),...o?[o]:[],...(t!=null?t:[]).map(h=>h.value)),y=Math.max(...e.map(h=>h.value),...o?[o]:[],...(t!=null?t:[]).map(h=>h.value)),v=Math.max(...e.map(h=>h.count),...(t!=null?t:[]).map(h=>h.count)),m=v*1.25,f=Math.max(Math.floor(q-3),0),w=Math.ceil(y+3);return be(f,w,m,e,l,s,i),ye(m,v,d,l),r&&qe(n,o,w,l,g,c),u}function be(e,n,o,t,r,a,u){var d,g;const s=100/(n-e+1),i=Math.ceil(20/s);for(let c=0;c<=n-e;c++){const l=e+c,q=(g=(d=t.find(v=>v.value===l))==null?void 0:d.count)!=null?g:0,y=q/o*100;if(c%i===0&&c!==0){const v=u.content.firstElementChild.cloneNode(!0),m=v.querySelector(".results__diagram-column-value"),f=v.querySelector(".results__diagram-horizontal-value");m.textContent=`${l}: ${q}`,f.textContent=S(l),v.style.height=`${y}%`,v.style.width=`${s}%`,r.appendChild(v)}else{const v=a.content.firstElementChild.cloneNode(!0),m=v.querySelector(".results__diagram-column-value");m.textContent=`${l}: ${q}`,v.style.height=`${y}%`,v.style.width=`${s}%`,r.appendChild(v)}}}function ye(e,n,o,t){const r=Math.ceil(n/5),a=r/e*100,u=Math.floor(e/r);for(let s=0;s<u;s++){const i=o.content.firstElementChild.cloneNode(!0);i.style.height=`${a*(s+1)}%`;const d=i.querySelector(".results__diagram-horizontal-line-text");d.textContent=(r*(s+1)).toString(),t.appendChild(i)}}function qe(e,n,o,t,r,a){const u=e/o*100,s=[];if(n){const g=n/o*100,c=r.content.firstElementChild.cloneNode(!0);c.style.width=`${g}%`;const l=c.querySelector(".results__diagram-average-text");l.textContent=S(n),s.push(c)}const i=a.content.firstElementChild.cloneNode(!0);i.style.width=`${u}%`;const d=i.querySelector(".results__diagram-value-text");d.textContent=S(e),s.push(i),n&&n>e&&s.reverse(),t.append(...s)}async function G(){if(H("showAveragesFor")==="none")return;const e=await k(),n=e.length,o=e.map(c=>c.pages.count).reduce((c,l)=>c+l,0)/n,t=e.map(c=>c.pages.meaningful).reduce((c,l)=>c+l,0)/n,r=Math.sqrt(e.map(c=>Math.pow(c.pages.count-o,2)).reduce((c,l)=>c+l,0)/n),a=Math.sqrt(e.map(c=>Math.pow(c.pages.meaningful-t,2)).reduce((c,l)=>c+l,0)/n),u=c=>{const l=c.map(m=>m.count).reduce((m,f)=>m+f,0)/n,q=Math.sqrt(c.map(m=>Math.pow(m.count-l,2)).reduce((m,f)=>m+f,0)/n),y=c.map(m=>m.perPage).reduce((m,f)=>m+f,0)/n,v=Math.sqrt(c.map(m=>Math.pow(m.perPage-y,2)).reduce((m,f)=>m+f,0)/n);return{average:l,deviation:q,perPageAverage:y,perPageDeviation:v}},s=u(e.map(c=>c.bubbles)),i=u(e.map(c=>c.words)),d=u(e.map(c=>c.characters)),g=e.some(c=>c.uniqueWords===void 0)?void 0:u(e.map(c=>c.uniqueWords));return{pages:{average:o,averageDeviation:r,meaningful:t,meaningfulDeviation:a},bubbles:s,words:i,characters:d,uniqueWords:g}}function b(e,n,o,t,r,a=!0){var l;const u=he(e.diagram,e.perPage,t==null?void 0:t.perPageAverage,r==null?void 0:r.diagram,a),s=document.querySelector(`.results__${n}`),i=s.querySelector(`.results__info-group[data-result-name='${o}']`),d=t===void 0?void 0:(e.count-t.average)/t.deviation;E(i,e.count,t==null?void 0:t.average,d);const g=s.querySelector(`.results__info-group[data-result-name='${o}PerPage']`),c=t===void 0?void 0:(e.perPage-t.perPageAverage)/t.perPageDeviation;E(g,e.perPage,t==null?void 0:t.perPageAverage,c),(l=s.querySelector(".results__diagram"))==null||l.remove(),s.appendChild(u)}function we(e){const n=Se(e),o=e.lines.flat().length,t=o/n,r=e.lines.map(f=>f.length),a=D(r),u=e.words.flat().length,s=u/n,i=e.words.map(f=>f.length),d=D(i),g=e.words.map(f=>U(f.join(""))),c=g.flat().reduce((f,w)=>f+w,0),l=c/n,q=D(g.flat()),y=new Set,v=e.words.map(f=>{const w=f.filter(h=>!y.has(h));return w.forEach(h=>y.add(h)),w}),m=v.flat().length;return{title:void 0,pages:{count:e.lines.length,meaningful:n},bubbles:{count:o,perPage:t,diagram:a},words:{count:u,perPage:s,diagram:d},characters:{count:c,perPage:l,diagram:q},uniqueWords:{count:m,perPage:m/n,diagram:v.map((f,w)=>({value:w+1,count:f.length}))}}}function D(e){const n=[];return e.forEach(o=>{const t=n.find(r=>r.value===o);if(t){t.count++;return}n.push({value:o,count:1})}),n}function Se(e){return e.lines.filter(n=>U(n.join(""))>10).length}function U(e){var n,o;return(o=(n=e.match(/[\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]/g))==null?void 0:n.length)!=null?o:0}function Ee(){We();const e=document.querySelector(".save__button"),n=document.querySelector(".save__title");n.addEventListener("input",()=>{e.disabled=n.value.trim()===""}),n.value="",e.addEventListener("click",()=>{var i;const a=n.value.trim();n.value="",e.disabled=!0;const u=Y();if(!u)return;const s=JSON.parse((i=window.localStorage.getItem("saves"))!=null?i:"[]");s.some(d=>d.title===a)?(Ae(),P=()=>{const d=s.findIndex(g=>g.title===a);s[d]=W(A({},u),{title:a}),window.localStorage.setItem("saves",JSON.stringify(s)),x(),F(a)}):(s.unshift(W(A({},u),{title:a})),window.localStorage.setItem("saves",JSON.stringify(s)),x(),N(),F(a))}),document.querySelector(".saved-values__reload-button").addEventListener("click",async()=>{const a=await k(!0);X(a)}),document.querySelector(".saved-values__download-json-button").addEventListener("click",Pe),document.querySelector(".saved-values__load-json-button").addEventListener("click",xe)}let P;function N(){var e;(e=document.querySelector(".save__container"))==null||e.classList.add("save__container--hidden")}function Le(){var e;(e=document.querySelector(".save__container"))==null||e.classList.remove("save__container--hidden")}function K(){document.querySelectorAll(".saved-value__compare-button").forEach(e=>{e.classList.remove("saved-value__compare-button--hidden")})}function Ce(){document.querySelectorAll(".saved-value__compare-button").forEach(e=>{e.classList.add("saved-value__compare-button--hidden")})}let C;async function x(e){var r;if(e!==void 0&&(C=e),window.localStorage.getItem("saves")===null){const a=await k();window.localStorage.setItem("saves",JSON.stringify(a))}const n=JSON.parse((r=window.localStorage.getItem("saves"))!=null?r:"[]"),o=document.querySelector("#savedValueTemplate"),t=document.querySelector(".saved-values__container");t.querySelectorAll(".saved-value__container").forEach(a=>a.remove()),n.forEach(a=>{var g;a.title===void 0&&(a.title="Untitled");const u=(g=o.content.firstElementChild)==null?void 0:g.cloneNode(!0),s=u.querySelector(".saved-value__name");s.textContent=a.title,s.title=a.title,u.querySelector(".saved-value__load-button").addEventListener("click",()=>{C==null||C(a),F(a.title),Z()}),u.querySelector(".saved-value__compare-button").addEventListener("click",()=>{De(a,a.title)}),t.appendChild(u)}),Y()!==void 0&&K()}function Pe(){var t;const e=(t=window.localStorage.getItem("saves"))!=null?t:"[]",n="data:text/json;charset=utf-8,"+encodeURIComponent(e),o=document.createElement("a");o.setAttribute("href",n),o.setAttribute("download","saves.json"),o.click(),o.remove()}function xe(){const e=document.createElement("input");e.type="file",e.accept=".json",e.addEventListener("change",()=>{var t;const n=(t=e.files)==null?void 0:t[0];if(!n)return;const o=new FileReader;o.onload=()=>{const r=JSON.parse(o.result);X(r)},o.readAsText(n)}),document.body.appendChild(e),e.click(),e.remove()}function X(e){var r;const t=[...JSON.parse((r=window.localStorage.getItem("saves"))!=null?r:"[]").filter(a=>!e.some(u=>u.title===a.title)),...e];window.localStorage.setItem("saves",JSON.stringify(t)),x()}function Ae(){document.querySelector(".save__confirm-popup-container").classList.remove("save__confirm-popup-container--hidden")}function J(){document.querySelector(".save__confirm-popup-container").classList.add("save__confirm-popup-container--hidden")}function We(){document.querySelector(".save__confirm-popup-button--yes").addEventListener("click",()=>{P==null||P(),J()}),document.querySelector(".save__confirm-popup-button--no").addEventListener("click",()=>{J()})}let p,_;function Y(){return p}async function De(e,n){var d,g;_=e,document.querySelector(".results").classList.add("results--comparing");const t=await G(),r=document.querySelector(".results__info-group[data-result-name='pagesCompare']"),a=t===void 0?void 0:(_.pages.count-t.pages.average)/t.pages.averageDeviation;E(r,_.pages.count,t==null?void 0:t.pages.average,a);const u=document.querySelector(".results__info-group[data-result-name='meaningfulPagesCompare']"),s=t===void 0?void 0:(_.pages.meaningful-t.pages.meaningful)/t.pages.meaningfulDeviation;E(u,_.pages.meaningful,t==null?void 0:t.pages.meaningful,s),b(_.bubbles,"compare-bubbles","bubblesCompare",t==null?void 0:t.bubbles,p==null?void 0:p.bubbles),b(_.words,"compare-words","wordsCompare",t==null?void 0:t.words,p==null?void 0:p.words),b(_.characters,"compare-characters","charactersCompare",t==null?void 0:t.characters,p==null?void 0:p.characters),_.uniqueWords&&b(_.uniqueWords,"compare-unique-words","uniqueWordsCompare",t==null?void 0:t.uniqueWords,p==null?void 0:p.uniqueWords,!1),(d=document.querySelector(".results__compare-unique-words"))==null||d.classList.toggle("results__group--hidden",!_.uniqueWords),b(p.bubbles,"bubbles","bubbles",t==null?void 0:t.bubbles,_.bubbles),b(p.words,"words","words",t==null?void 0:t.words,_.words),b(p.characters,"characters","characters",t==null?void 0:t.characters,_.characters),p.uniqueWords&&b(p.uniqueWords,"unique-words","uniqueWords",t==null?void 0:t.uniqueWords,_.uniqueWords,!1),(g=document.querySelector(".results__unique-words"))==null||g.classList.toggle("results__group--hidden",!(p!=null&&p.uniqueWords));const i=document.querySelector(".results__compare-column-title--compare .results__compare-column-title-subtext");i.innerText=n}function Z(){_=void 0,document.querySelector(".results").classList.remove("results--comparing")}function F(e){const n=document.querySelector(".results__compare-column-title--current .results__compare-column-title-subtext");n.innerText=e}function Te(){const e=document.querySelector(".results__compare-column-title--current .results__compare-column-title-subtext");e.innerText=""}function $(){var e;(e=document.querySelector(".results"))==null||e.classList.add("results--hidden")}async function z(e){var d,g;(d=document.querySelector(".results"))==null||d.classList.remove("results--hidden");const n=H("showAveragesFor"),o=document.querySelector(".results");o.dataset.showAveragesFor=n;const t="title"in e?e:we(e),r=await G();p=t,K();const a=document.querySelector(".results__info-group[data-result-name='pages']"),u=r===void 0?void 0:(t.pages.count-r.pages.average)/r.pages.averageDeviation;E(a,t.pages.count,r==null?void 0:r.pages.average,u);const s=document.querySelector(".results__info-group[data-result-name='meaningfulPages']"),i=r===void 0?void 0:(t.pages.meaningful-r.pages.meaningful)/r.pages.meaningfulDeviation;E(s,t.pages.meaningful,r==null?void 0:r.pages.meaningful,i),b(t.bubbles,"bubbles","bubbles",r==null?void 0:r.bubbles),b(t.words,"words","words",r==null?void 0:r.words),b(t.characters,"characters","characters",r==null?void 0:r.characters),t.uniqueWords&&b(t.uniqueWords,"unique-words","uniqueWords",r==null?void 0:r.uniqueWords,void 0,!1),(g=document.querySelector(".results__unique-words"))==null||g.classList.toggle("results__group--hidden",!t.uniqueWords),document.querySelectorAll(".results__diagram-column").forEach(c=>{const l=c.style.height;c.animate([{height:"0"},{height:l}],500)})}let T;async function k(e=!1){if(T&&!e)return T;const n=await(await fetch("selected_results.json")).json();return T=n,n}async function Ie(){Ee(),ae(),x(async o=>{N(),$(),await z(o)}),_e(),ce(async o=>{N(),$(),Ce(),Z(),Te();const t=await le(o);await z(t),Le()});const e=document.querySelector(".sidebar__toggle-icon"),n=document.querySelector(".sidebar__container");e.addEventListener("click",()=>n.classList.toggle("sidebar__container--closed"))}document.addEventListener("DOMContentLoaded",Ie);
